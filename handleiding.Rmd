---
title: "Tutorial woonuitbreidingsgebieden (WUG)"
author: "Stijn Van Hoey"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE,
                       fig.height = 8, fig.width = 8)
```

## Introduction

In this document, a short overview of the functions developed to make the WUG Rshiny application are showcased, as they can be used outside the scope of the application as well. For example, when making reports or doing other data analysis.

The different are not organised in a package, but can be enabled by sourcing the individual files (or run inside Rstudio). Make sure you have n Rstudio project running with the repository main folder as the working directory of your project:

```{r loadfun}
source('src/support.R')
source("src/get_esd_data.R")
source("src/get_landuse_data.R")
source("src/create_radar.R")
source("src/create_stacked_bar.R")
```

On the one hand, the `get_*` functions are created to extract the data from the data source (excel-file). On the other hand, the `create_*` functions are used to make the graphs. The `support.R` script provide some additional help functions.

The individual functions operate on a single WUG, based on the WUG code. For a given WUG code, the data can be extracted (in a tidy structure) and consecutively, the graphs can be made. The structuring of the data as a tidy format supports easy handling with e.g. `ggplot2`.

In this tutorial, we will use the WUG `11002_08` to illustrate the functions.

```{r }
id_wug <- "11002_08"
xls_file <- "data/Afwegingskader_Wug_versie2.xlsx"
```

## Landuse plots

### Comparison percentage of area

To create the landuse plots, load the landuse data:

```{r landuse_load}
lu_data <- get_landuse_percent(xls_file, id_wug)
```

and create the graph:
```{r landuse_plot}
create_stacked_bar(lu_data)
```

### Relative loss in the municipality

TODO

## Ecosystem services adar chart

Similar to the landuse data, loading the data:

```{r esd_load}
esd_data <- get_esd_data(xls_file, id_wug)
```

and create the graph:
```{r esd_plot}
create_radar(esd_data, reference = "gemeente", threshold = 0.5)
```

Within the latter function, the option to chooce a `reference` is included, providing the option to compare the ecosystem services of the individual WUG with the ecosystem services of the following options:

* Gemeente : use `'gemeente'` as reference
* Vlaanderen : use `'vlaanderen'` as reference
* WUG gemeente : use `'wug_gemeente'` as reference
* WUG provincie : use `'wug_provincie'` as reference
* WUG Vlaanderen : use `'wug_vlaanderen'` as reference

As such, to make the comparison with the ESD of all the WUG area in the province, is is done as follows:
```{r esd_plot_province}
create_radar(esd_data, reference = "wug_provincie")
```

The threshold is the comparison value to compare with. The default is 0.5, but this can overwritten.




